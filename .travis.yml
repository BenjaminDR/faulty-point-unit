os: linux
dist: bionic

language: cpp

addons:
  apt:
    packages:
      - build-essential
      - ocaml 
      - ocamlbuild
      - automake
      - autoconf
      - libtool
      - wget
      - python
      - python3 
      - python3-pip
      - libssl-dev
      - git
      - cmake
      - perl
      - libssl-dev
      - libcurl4-openssl-dev
      - protobuf-compiler
      - libprotobuf-dev
      - debhelper
      - reprepro
      - unzip
      - libboost-dev

notifications:
  email: true

jobs: # Add two jobs for each type of paper test, for each SDK
  include:
    - name: "Table 1 - Patched SDK"
      script: ./sdk_helper.sh install_patched && source ./sdk_helper.sh patched && cd 01_table1_basic-poc && ./eval_simulator.sh
    - name: "Table 1 - Vulnerable SDK"
      script: ./sdk_helper.sh install_vulnerable && source ./sdk_helper.sh vulnerable && cd 01_table1_basic-poc && ./eval_simulator.sh
    - name: "Table 3 - Patched SDK (minimal run to not exceed Travis timeout)"
      script: ./sdk_helper.sh install_patched && source ./sdk_helper.sh patched && cd 04_section-5_mnist-javascript/eval/ && ./run_tests.py --simulator --mnist ../js-files/mnist_handwritten_test_first5.json -a 5 && ./eval.py -p $(ls -a | grep SIM)
    - name: "Table 3 - Vulnerable SDK (minimal run to not exceed Travis timeout)"
      script: ./sdk_helper.sh install_vulnerable && source ./sdk_helper.sh vulnerable && cd 04_section-5_mnist-javascript/eval/ && ./run_tests.py --simulator --mnist ../js-files/mnist_handwritten_test_first5.json -a 5 && ./eval.py -p $(ls -a | grep SIM)